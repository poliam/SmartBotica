{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}

{% block title %}Edit Medicine{% endblock title %}

{% block content %}
<div class="container my-5">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <h1 class="text-center text-primary">
                <i class="fas fa-edit mr-2"></i>
                Edit Medicine
            </h1>
            <hr>
            <form id="editMedicineForm" method="post" action="">
                {% csrf_token %}
                <div class="form-group">
                    <label for="id_generic_name">Generic Name</label>
                    {{ form.generic_name|attr:"class:form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_brand_name">Brand Name</label>
                    {{ form.brand_name|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_dosage_strength">Dosage Strength</label>
                    {{ form.dosage_strength|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_form">Dosage Form</label>
                    {{ form.form|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_classification">Classification</label>
                    {{ form.classification|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_pharmacologic_category">Pharmacologic Category</label>
                    {{ form.pharmacologic_category|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_threshold">Threshold (Minimum Stock Level)</label>
                    {{ form.threshold|add_class:"form-control" }}
                </div>
                <div class="form-group text-center mt-4">
                    <button type="button" class="btn btn-primary px-4" data-bs-toggle="modal" data-bs-target="#confirmEditModal">
                        <i class="fas fa-save mr-2"></i> Save Changes
                    </button>
                    <a href="{% url 'add-medicine-history' %}" class="btn btn-secondary px-4">
                        <i class="fas fa-times mr-2"></i> Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Confirmation Modal -->
<div class="modal fade" id="confirmEditModal" tabindex="-1" aria-labelledby="confirmEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmEditModalLabel">Confirm Save Changes</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to save these changes?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmSave">Yes, Save Changes</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const confirmSaveButton = document.getElementById("confirmSave");
        const editMedicineForm = document.getElementById("editMedicineForm");

        confirmSaveButton.addEventListener("click", function () {
            editMedicineForm.submit();
        });
    });
</script>
{% endblock content %}
